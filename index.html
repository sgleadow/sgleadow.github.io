
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Stewart Gleadow's Blog</title>
  <meta name="author" content="Stewart Gleadow">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  

  <link rel="canonical" href="http://sgleadow.github.com/index.html"/>
  <link href="/favicon.png" rel="shortcut icon" />
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="http://s3.amazonaws.com/ender-js/jeesh.min.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Stewart Gleadow's Blog" type="application/atom+xml"/>
  <!--Fonts from Google's Web font directory at http://google.com/webfonts -->
<link href='http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic' rel='stylesheet' type='text/css'>

</head>

<body  >
  <header><hgroup>
  <h1><a href="/">Stewart Gleadow's Blog</a></h1>
  
    <h2>My ramblings about iOS and other software topics.</h2>
  
</hgroup>

</header>
  <nav role=navigation><ul role=subscription data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
<form action="http://google.com/search" method="get">
  <fieldset role="site-search">
    <input type="hidden" name="q" value="site:sgleadow.github.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
<ul role=main-navigation>
  <li><a href="/about.html">About</a></li>
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/talks.html">Talks</a></li>
  <li><a href="https://github.com/sgleadow">Code</a></li>
  <li><a href="http://twitter.com/stewgleadow">Twitter</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">



  <article>
    
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/10/28/universal-static-libraries-and-frameworks-for-ios/">Universal Static Libraries and Frameworks for iOS</a></h1>
    
    
      <p class="meta">





  



<time datetime="2011-10-28T17:48:00+11:00" pubdate  data-updated="true" >Oct 28<span>th</span>, 2011</time></p>
    
  </header>


  <div class="entry-content"><p>You only have to look at github to see the explosion of new open source iOS frameworks. Incorporating third party libraries into your app is still a pain. I spent today fighting with static libraries and frameworks for the <a href="https://github.com/domesticcatsoftware/DCIntrospect">DCIntrospect</a> library, and I think I won, so that&#8217;s got to be work writing about.</p>

<p>The changes I made can be see on <a href="https://github.com/sgleadow/DCIntrospect">my fork of DCIntrospect</a>.</p>

<h2>Static libraries and frameworks</h2>

<p>Until recently, my default use case was to actually drag in the source files from a third party library and compile it into my application. For libraries that I have forked and plan to modify or extend, this would still be my preferred option. Some third party libraries are stable and reliable, and I do not wish to change the source code at all. For these tools, I would prefer to just drag in a static library or framework and get on with my own app.</p>

<p>I&#8217;ve tried my hand at static libraries before, and it definitely wasn&#8217;t plain sailing. A twitter conversation between two local iOS devs, <a href="http://twitter.com/#!/patr">Pat</a> and <a href="http://twitter.com/#!/orj">Oliver</a> prompted me to have another go at getting these libraries working. Pat&#8217;s own tool, <a href="https://github.com/domesticcatsoftware/DCIntrospect">DCIntrospect</a> is a perfect example. It&#8217;s a great tool for introspecting and testing strange UI layout behaviour in your app, and it&#8217;s a library that <em>just works</em> (famous last words, I bet you find a bug in it now)&#8230; but credit to Pat, I&#8217;ve used it on a few apps, and never touched the source code. DCIntrospect seems like a good case for bundling everything up in a library.</p>

<h2>Static Library</h2>

<p>I created an  Xcode 4 workspace for DCIntrospect, which initially just contained the existing <em>DCIntrospectDemo</em>. The demo included the source code directly, so I removed the references to those files and created a new static library project that included the existing DCIntrospect source files. That basically compiled straight away, but to make it useful, I had to tweak a few build settings.</p>

<p>The target name is DCIntrospectStaticLib, but I wanted the output to be libDCIntrospect.a, which can be done by changing the <strong>Product Name</strong> build setting. I also wanted to group the header files with the compiled binary, so I set the <strong>Public Headers Folder Path</strong> to be <code>$(PRODUCT_NAME)</code> so that it would match whatever I entered for the product name.</p>

<p>To link to this static library, you simply have to drag it into your project. Xcode sorts out adjusting the <strong>Library Search Paths</strong> automatically when you add the library. However, if you want to import headers and make calls to the library, you will need to manually set the <strong>Header Search Paths</strong>. For DCIntrospectDemo, the search path is <code>"$(SRCROOT)/../Products/lib"</code> and then use <code>#import &lt;DCIntrospect/DCIntrospect.h&gt;</code>. That&#8217;s easy enough to do, but it is one more barrier to entry for people using the library. A static framework could make it a single step.</p>

<h2>Static Framework</h2>

<p>I followed the steps described in <a href="http://twitter.com/#!/dineybomfim">Diney Bomfim&#8217;s</a> updated post on building a <a href="http://db-in.com/blog/2011/07/universal-framework-iphone-ios-2-0/">universal framework for iPhone</a>, and it all went pretty smoothly. He describes the different build settings you have to adjust to get it all to work.</p>

<p>Diney&#8217;s instructions also include a sample shell script for compiling a universal static library using the <code>lipo</code> tool. I adjusted the script slightly, so that it would build both a universal static library as well as the static framework. I haven&#8217;t had much success running DCIntrospect on the device, so I&#8217;m not sure if that part is working or not.</p>

<p>The joy of using the static framework in this way is that installing DCIntrospect is now a single drag and drop of a framework into your source code. To get it working at this point, you would still need to add <code>#import &lt;DCIntrospect/DCIntrospect.h&gt;</code> into your app delegate and after you have loaded the window, call <code>[[DCIntrospect sharedIntrospector] start]</code>.</p>

<h2>Automatic Loading of DCIntrospect</h2>

<p>My next task is to get DCIntrospect to automatically load if it is linked to your target. I had a play around with this a few months ago with the <a href="https://github.com/moredip/Frank">Frank iOS testing library</a>, with some success but never pursued the final solution, but <a href="http://twitter.com/#!/beingagile">Pete Hodgson</a> obviously got sick of waiting for me and did it himself.</p>

<p>The solution is pretty neat. You basically hook into when a class in the library is being loaded, and set yourself up to listen for the <code>UIApplicationDidBecomeActiveNotification</code> notification, which gets called after the app delegate <code>- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions</code> gets called. When that happens, we start DCIntrospect. I&#8217;ve wrapped the call to load DCIntrospect in a check that we are running in the simulator, so it will never be called on the app we submit to Apple. Initially I tried to do a check using <code>#ifdef DEBUG</code>, but that wont work with the static precompiled library approach, since those flags are only valid when the library is initially compiled, not at run time.</p>

<figure role=code><figcaption><span></span></figcaption><div class="highlight"><table cellpadding="0" cellspacing="0"><tr><td class="gutter"><pre class="line-numbers"><span class='line'>1</span>
<span class='line'>2</span>
<span class='line'>3</span>
<span class='line'>4</span>
<span class='line'>5</span>
<span class='line'>6</span>
<span class='line'>7</span>
<span class='line'>8</span>
<span class='line'>9</span>
<span class='line'>10</span>
<span class='line'>11</span>
<span class='line'>12</span>
<span class='line'>13</span>
<span class='line'>14</span>
<span class='line'>15</span>
<span class='line'>16</span>
<span class='line'>17</span>
<span class='line'>18</span>
<span class='line'>19</span>
<span class='line'>20</span>
<span class='line'>21</span>
<span class='line'>22</span>
<span class='line'>23</span>
<span class='line'>24</span>
<span class='line'>25</span>
<span class='line'>26</span>
<span class='line'>27</span>
<span class='line'>28</span>
<span class='line'>29</span>
<span class='line'>30</span>
</pre></td><td class='code' width='100%'><pre><code class='objc'><div class='line'><span class="cp">#import &quot;DCIntrospect.h&quot;</span>
</div><div class='line'>
</div><div class='line'><span class="k">@interface</span> <span class="nc">DCIntrospectLoader</span> : <span class="nc">NSObject</span>
</div><div class='line'><span class="k">@end</span>
</div><div class='line'>
</div><div class='line'><span class="k">@implementation</span> <span class="nc">DCIntrospectLoader</span>
</div><div class='line'>
</div><div class='line'><span class="c1">// This is called after application:didFinishLaunchingWithOptions:</span>
</div><div class='line'><span class="c1">// so the statusBarOrientation should be reported correctly</span>
</div><div class='line'><span class="o">+</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nl">applicationDidBecomeActive:</span><span class="p">(</span><span class="n">NSNotification</span> <span class="o">*</span><span class="p">)</span><span class="n">notification</span>
</div><div class='line'><span class="p">{</span>
</div><div class='line'>    <span class="n">NSString</span> <span class="o">*</span><span class="n">simulatorRoot</span> <span class="o">=</span> <span class="p">[[[</span><span class="n">NSProcessInfo</span> <span class="n">processInfo</span><span class="p">]</span> <span class="n">environment</span><span class="p">]</span> <span class="nl">objectForKey:</span><span class="s">@&quot;IPHONE_SIMULATOR_ROOT&quot;</span><span class="p">];</span>
</div><div class='line'>    <span class="k">if</span> <span class="p">(</span><span class="n">simulatorRoot</span><span class="p">)</span>
</div><div class='line'>    <span class="p">{</span>
</div><div class='line'>        <span class="n">NSLog</span><span class="p">(</span><span class="s">@&quot;Running in simulator, loading DCIntrospect&quot;</span><span class="p">);</span>
</div><div class='line'>        <span class="p">[[</span><span class="n">DCIntrospect</span> <span class="n">sharedIntrospector</span><span class="p">]</span> <span class="n">start</span><span class="p">];</span>
</div><div class='line'>    <span class="p">}</span>
</div><div class='line'><span class="p">}</span>
</div><div class='line'>
</div><div class='line'><span class="o">+</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">load</span>
</div><div class='line'><span class="p">{</span>
</div><div class='line'>    <span class="n">NSLog</span><span class="p">(</span><span class="s">@&quot;Injecting DCIntrospect loader&quot;</span><span class="p">);</span>
</div><div class='line'>
</div><div class='line'>    <span class="p">[[</span><span class="n">NSNotificationCenter</span> <span class="n">defaultCenter</span><span class="p">]</span> <span class="nl">addObserver:</span><span class="p">[</span><span class="n">self</span> <span class="n">class</span><span class="p">]</span>
</div><div class='line'>                                             <span class="nl">selector:</span><span class="k">@selector</span><span class="p">(</span><span class="nl">applicationDidBecomeActive:</span><span class="p">)</span>
</div><div class='line'>                                                 <span class="nl">name:</span><span class="s">@&quot;UIApplicationDidBecomeActiveNotification&quot;</span>
</div><div class='line'>                                               <span class="nl">object:</span><span class="nb">nil</span><span class="p">];</span>
</div><div class='line'><span class="p">}</span>
</div><div class='line'>
</div><div class='line'><span class="k">@end</span>
</div></code></pre></td></tr></table></div></figure>


<p>With the auto loading class above now part of DCIntrospect, installation is literally a single drag and drop of the framework. It will automatically load as needed, as long as we are running in the simulator. I usually have a separate target for App Store submission without any test libraries linked into it just in case, since they bloat the binary and probably call some private API magic at some point.</p>

<h2>DCIntrospect Demo Project</h2>

<p>To use either the static library or the framework in the two demo project targets, the only change I had to make was to add the <em>-ObjC</em> setting to <strong>Other Linker Flags</strong>. For the static library, you still need to set a header path but only if you want to make direct calls to DCIntrospect, since it now loads automatically.</p>

<p>Since I had both the DCIntrospect and DCIntrospectDemo projects in the same workspace, XCode 4 had the smarts to find the <em>implicit dependency</em>, so when I edit the library source code, it&#8217;s automatically rebuilt. However, I set up the project to use the <em>BundleProducts</em> target to create the universal distributable binaries, which did not get picked up as a dependency.</p>

<p>You can create <em>explicit dependencies</em> between targets in different projects by first creating a project dependency. That is, dragging the dependent project into the demo project. Once that is done, when editing the <strong>Target Dependencies</strong> in the demo target&#8217;s <em>Build Phases</em>, you will be able to explicitly select the dependency. In this case, it is the <em>BundleProducts</em> target.</p>

<p>Unless you plan to edit the source code and recompile the binary often, the chances are you wont need to set up the project dependencies like this.</p>

<h2>Issues with static libraries and frameworks</h2>

<p>DCIntrospect is a fairly simple framework to generate. Larger libraries are likely to come across two issues, neither of which affect DCIntrospect.</p>

<ul>
<li>categories from static libraries don&#8217;t seem to load properly</li>
<li>resources is static libraries or frameworks need to be linked into the target using them separately</li>
</ul>


<p>For the categories issue, I know if two solutions. First, you can add <em>-all_load</em> to the <strong>Other Linker Flags</strong> section of the target using the static library. We&#8217;ve already added the <em>-ObjC</em> flag in there, so it&#8217;s not really adding much of a burden. The other option is to use Karl Stenerud&#8217;s <em>MAKE_CATEGORIES_LOADABLE</em> as <a href="https://github.com/moredip/Frank/blob/master/LoadableCategory.h">used in Frank</a>.</p>

<p>For the resources issue, you can generate a resource bundle along with your static library or framework. When linking the library to your target, you can also drag in the resources bundle as a dependency and it should work. Karl has a neat way of making this even easier in his <a href="https://github.com/kstenerud/iOS-Universal-Framework">iOS Univeral Framework</a> project in github. He creates an <em>embedded framework</em>, which is essentially a single container for both the static framework and the resources bundle. This extra container makes it easy to drag in a single <em>.embeddedframework</em> file into your project and have everything link up correctly.</p>

<h2>Final Thoughts</h2>

<p>This is probably the first time I have fought with static libraries and frameworks and felt like I came out on top, and DCIntrospect seems like a good case for using it. That said, there are lots of libraries I use where I prefer being able to see the source code, and potentially edit the implementation. For those, git submodules and adding the source directly is still my preferred option. The single drag-and-drop solution here does make using a new library pretty easy though.</p>
</div>
  
  


  </article>


  <article>
    
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/10/26/which-automated-ios-testing-tool-to-use/">Which Automated iOS Testing Tool to Use</a></h1>
    
    
      <p class="meta">





  



<time datetime="2011-10-26T22:38:00+11:00" pubdate  data-updated="true" >Oct 26<span>th</span>, 2011</time></p>
    
  </header>


  <div class="entry-content"><p>I&#8217;ve been playing around with testing frameworks on iOS for over a year now. There are quite a few out there, all with communities building around them, but I think there are currently a few that stand out:</p>

<ul>
<li>Frank</li>
<li>KIF</li>
<li>UIAutomation</li>
</ul>


<p>Other tools that might be worth looking at, but I haven&#8217;t used and wont comment on are: NativeDriver, LessPainful, iCuke and UISpec.</p>

<p>I recently watched a recording of Pete Hodgson (@beingagile), the primary maintainer of Frank in which he gave a quick summary of the other testing tools, and when it might be appropriate to use them. I made a few notes, and added some of my own thoughts. There is a <a href="http://pivotallabs.com/talks/147-frank-cucumber-tests-for-native-ios-apps">video of the talk</a> Pete gave at <a href="http://pivotallabs.com/">Pivotal Labs</a>.</p>

<h2>Frank</h2>

<p>Frank has been described as Selenium for native iOS apps. It&#8217;s a tool written mainly by some fellow Thoughtworkers that uses a combination of <a href="http://cukes.info/">Cucumber</a> and JSON commands that are sent to a server running inside your native application, and leverages <a href="http://code.google.com/p/uispec/">UISpec</a> to run the commands. Frank used to require changes to your production code, but that&#8217;s got a lot easier with the new static library approach.</p>

<p>I&#8217;ve used Frank quite a bit, and I like it. I have a lot more I could say about it, but I&#8217;ll leave that for another time. You can find out more about Frank at:</p>

<ul>
<li><a href="http://www.testingwithfrank.com">Frank&#8217;s new home page</a></li>
<li><a href="https://github.com/moredip/Frank">The github page for Frank</a></li>
<li><a href="/talks.html">A slightly out of date talk I gave on Frank</a></li>
</ul>


<p><strong><em> The good parts of Frank </em></strong></p>

<ul>
<li>Clean CSS-like selector syntax, allowing for fairly tolerant tests</li>
<li>Active community discussing and extending the library</li>
<li>Driven by Cucumber (if you&#8217;re a cuke fan)</li>
<li>Includes <em>Symbiote</em>, a live introspection tool</li>
<li>Command line and CI come pretty much for free</li>
</ul>


<p><strong><em> The bad parts of Frank </em></strong></p>

<ul>
<li>Difficult, but not impossible, to run on the device</li>
<li>Separation between tests/native code over HTTP can confuse the cause of failure</li>
<li>Decoupling test/native code into separate processes makes it a bit slower (Pete makes the good point that most of the slowness in your iOS tests are likely to be waiting for animations and transitions, not the HTTP communication)</li>
<li>Very little support for gestures (but hopefully that&#8217;s coming soon)</li>
</ul>


<p><strong><em> When using Frank might be appropriate </em></strong></p>

<ul>
<li>Your team has experience with web application testing tools (Selenium, Cucumber)</li>
<li>You prefer a BDD style of development, with CI support</li>
<li>Your app is not driven by complex gestures</li>
<li>You have a goal of having cross platform tests across Android, iOS and mobile web</li>
</ul>


<h2>KIF</h2>

<p>KIF is an Objective C based framework written at Square. It&#8217;s a nice solid implementation from what I&#8217;ve seen, with active development going on. Since it&#8217;s Objective C, you can call out to anything else in your app as well. It&#8217;s a brand new test framework, so it&#8217;s not going to immediately integrate with other tools (like JUnit-style XML output and that kind of thing). I haven&#8217;t KIF a lot yet, so I can&#8217;t comment too much but I think it shows a lot of promise. You can find out more about KIF at:</p>

<ul>
<li><a href="https://github.com/square/KIF">The github repo</a></li>
<li><a href="https://groups.google.com/group/kif-framework">KIF Google group</a></li>
<li><a href="http://corner.squareup.com/2011/07/ios-integration-testing.html">The initial blog post on KIF from Square</a></li>
</ul>


<p><strong><em> The good parts of KIF </em></strong></p>

<ul>
<li>Your tests are in Objective C. Everything in one language, easier for pure iOS devs to pick up</li>
<li>Active community and good support</li>
<li>Pretty reasonable support for gestures</li>
<li>Command line and CI</li>
</ul>


<p><strong><em> The bad parts of KIF </em></strong></p>

<ul>
<li>Your tests are in Objective C. Non-devs will find it hard to read, doesn&#8217;t make a great executable spec)</li>
<li>Tricky to integrate with back end stubs because it&#8217;s all running in-process</li>
<li>Not stand alone</li>
</ul>


<p><strong><em> When using KIF might be appropriate </em></strong></p>

<ul>
<li>Primarily a developer driven team</li>
<li>Developers have stronger Objective C skills than Ruby/Cucumber/Javascript</li>
<li>Don&#8217;t need business folk to read or write test specs</li>
<li>Don&#8217;t want to deal with the whacky regex from Cucumber</li>
<li>Don&#8217;t have really complex back end interactions to stub out</li>
<li>Don&#8217;t have cross platform requirements</li>
</ul>


<h2>UIAutomation</h2>

<p><a href="http://developer.apple.com/library/ios/#documentation/DeveloperTools/Reference/UIAutomationRef/Introduction/Introduction.html">UIAutomation</a> is Apple&#8217;s own solution for automated testing. It runs tests written in Javascript through the Instruments application that comes with the developer tools. It sounds like a no-brainer to use Apple&#8217;s solution for building iOS apps, but I&#8217;ve found it a real pain to deal with in practice. UIAutomation is pretty good for actually driving the UI, but not great for organising and running a test suite, especially from CI. My impression is that Apple QA staff must use UIAutomation for test scripts with profiling instruments attached and actually sit there and watch, it doesn&#8217;t seem to be purpose built for fully automated testing.</p>

<p>At this point I would like to link to a lot of useful documentation about UIAutomation, but in practice I have found Apple&#8217;s documentation to be either minimal or non-existent, and very little online discussion past the &#8220;boot up an app and tap a button in a single javascript file&#8221;.</p>

<p><strong><em> The good parts of UIAutomation </em></strong></p>

<ul>
<li>Apple&#8217;s own tool. Doing things the way Apple wants is generally a good idea (and as Pete mentions, Apple&#8217;s not going to go bust or quit iOS any time soon, so the chances are it will be supported)</li>
<li>More closely linked to the device, I primarily run UIAutomation tests on the device, not in the simulator</li>
<li>Good support for gestures (pinch zooming and swipes) and rotation</li>
</ul>


<p><strong><em> The bad parts of UIAutomation </em></strong></p>

<ul>
<li>Not built with CI in mind. The command line integration is pretty bad</li>
<li>Can&#8217;t integrate with other tools very well</li>
<li>It&#8217;s Apple&#8217;s tool, and it&#8217;s not open source. You can&#8217;t jump in and fix the bits that are missing</li>
<li>Runs within Instruments, seems to be aimed at regression testing not TDD and aimed at QAs not devs</li>
</ul>


<p><strong><em> When using UIAutomation might be appropriate </em></strong></p>

<ul>
<li>You have a separation between development and QA on your team</li>
<li>You prefer regression test suites over a test-first approach</li>
<li>You don&#8217;t really care about CI</li>
<li>You prefer manual QA and you just want to speed that up a bit</li>
</ul>


<h2>Conclusion</h2>

<p>So far I&#8217;ve used Frank and UIAutomation on fairly large projects, and I&#8217;m very keen to try KIF. Ideally what I would like is the Frank architecture using Cucumber to drive your tests, but using KIF&#8217;s implementation on the native side which is a lot more solid than UISpec. Frank would give nice clean readable test features, and integration with other tools through cucumber as well as the concise selector syntax. KIF would give gesture support and a much cleaner implementation of those features.</p>
</div>
  
  


  </article>


  <article>
    
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/10/14/enabling-accessibility-for-ios-applications/">Enabling Accessibility for iOS Applications</a></h1>
    
    
      <p class="meta">





  



<time datetime="2011-10-14T16:24:00+11:00" pubdate  data-updated="true" >Oct 14<span>th</span>, 2011</time></p>
    
  </header>


  <div class="entry-content"><p>I&#8217;m looking to write up a few posts about using accessibility for testing native iOS applications. Here is the first one, dealing with enabling accessibility for your apps in the simulator and on the device.</p>

<h2>Why use accessibility</h2>

<p>Firstly, the iPhone and iPad are setting a new standard for usability by impaired users. That&#8217;s a great thing, and I think we should be making a bigger effort to support these features. Apple provides assistants like VoiceOver that use the building UIAccessibility framework. If you&#8217;d like to find out more about accessibility for the sake of accessibility, <a href="http://mattgemmell.com/2010/12/19/accessibility-for-iphone-and-ipad-apps/">Matt Gemmell</a> has a great post on the topic</p>

<p>A great side effect of making an app accessible to assistive devices is that the app also becomes easier to test in an automated fashion. This post is not about how and why to use accessibility to test your app (although that is a valid topic that I will write a separate post on), it a quick guide to turning accessibility on. Generally, the properties of the UIAccessibilty framework are only available to third party testing tools like <a href="http://www.testingwithfrank.com/">Frank</a> and <a href="https://github.com/square/KIF">KIF</a> if you have accessibility enabled for the application, either in the simulator or on the device.</p>

<h2>Enabling accessibility in the Simulator</h2>

<p>During development, we need to enable accessibility for both OS X and the iOS Simulator. Under Mac OS X, open up the System Preferences and open the <em>Universal Access</em> pane at the top right. In the pane that opens, check the box for <em>Enable Access for Assistive Devices</em>. The OS will persist this setting from now on.</p>

<p><img class='' src='/images/posts/accessibility/osx-prefs.png' width='' height='' alt='Universal Access in the OS X Preferences' title='Universal Access in the OS X Preferences'>
<img class='' src='/images/posts/accessibility/enable-osx-prefs.png' width='' height='' alt='Universal Access in the OS X Preferences' title='Universal Access in the OS X Preferences'></p>

<p>Load the iOS Simulator and open the <em>Settings</em> application. Enable accessibility using the switch under <em>General > Accessibility</em>. If you see a little coloured box appear, you have successfully enabled accessibility in the simulator. The setting is stored in an underlying plist file under that iOS version of the simulator, so you will need to enable this setting for for both iOS 4 and 5 separately, but that will effect all of the device types (iPhone, iPhone Retina and iPad) for that OS version. The iOS Simulator will keep accessibility enabled as long as you don&#8217;t clear out its settings. If you&#8217;re anything like me, you have <em>Reset Content and Settings</em> mapped to a keyboard shortcut, you&#8217;ll regularly need to navigate in and re-enable accessibility.</p>

<p><img class='right ' src='/images/posts/accessibility/enable-on-simulator.png' width='' height='' alt='Enable accessibility in the iOS Simulator' title='Enable accessibility in the iOS Simulator'></p>

<p>The small coloured box that appears is called the accessibility inspector. It shows a small summary of what is available from the UIAccessibility framework for iOS. There are two main types of information shown in the inspector: notifications and properties. Notifications are fired when the UI changes. To be honest, I&#8217;ve not played around with firing accessibility notifications much at all. Notifications could be a potential solution for tests that need to &#8216;wait&#8217; until a screen transition is finished before continuing rather than busy-waiting or just a plain old sleep (you know it&#8217;s not a real test suite unless there are a couple of <em>sleep</em> calls in there!).</p>

<p>The properties show aspects of the selected UI element. With the accessibility inspector expanded, tap around in some of Apple&#8217;s built in applications to see the UIAccessibility properties. With the accessibility inspector expanded like this, the first touch even brings up the accessibility - which is great if that&#8217;s the only way to use the app, but can get in the way if you&#8217;re not used to it. If you collapse the inspector using the little cross-button, touch interaction returns to normal.  In the image above I&#8217;ve collapsed the accessibility inspector and dragged it to the side, since the properties are available to our tests anyway, so it&#8217;s easiest to get it as far off the screen as possible.</p>

<h2>Enabling accessibility on the device</h2>

<p>Usually, to get access to the accessibility framework on an actual iOS device, you need to enable <em>VoiceOver</em>. If you do your testing with Apple&#8217;s sanctioned UIAutomation Instrument, it seems to be able to hook in automatically without you having to specifically enable those features. Although with iOS 5, I&#8217;ve found that to not always be the case.</p>

<p>VoiceOver is pretty easy to enable in the Settings app under <em>General > Accessibility > VoiceOver</em>. Once this is enabled, the device acts in a similar way to when you have the accessibility inspector visible in the simulator. A pleasant computerised voice now describes your every gesture, and more importantly, activates the accessibility framework for all applications, including the one you want to test. Your first tap will select a UI element and read the available information about it. Double-tapping actually executes the action for a button. People using VoiceOver as a means to navigate the OS are likely to drag their finger on the screen to get a better idea of where items are relative to each other, so single-finger scrolling is also disabled. You can scroll by dragging with three fingers.</p>

<p><img class='left ' src='/images/posts/accessibility/itunes-configure-accessibility.png' width='' height='' alt='Configure Universal Access in iTunes' title='Configure Universal Access in iTunes'>
<img class='left ' src='/images/posts/accessibility/itunes-voiceover-on.png' width='' height='' alt='Enable VoiceOver in iTunes' title='Enable VoiceOver in iTunes'></p>

<p>Navigate some well known apps on the phone, and see how Apple&#8217;s own applications integrate with VoiceOver. To actually design an accessible application, you&#8217;ll be wanting to spend a whole lot of time using VoiceOver yourself to get an idea of what information is useful and necessary. At some stage, you will pick up a test device with VoiceOver on, so itâ€™s good to know at least how to get into the settings and turn accessibility off in order to operate manually.</p>

<p>If you are only enabling VoiceOver for testing purposes, the changed gestures and audio instructions can seem to get in the way of you just using the device. If you regularly switch accessibility on and off, using iTunes is going to be much more convenient. Before the latest version of iTunes, enabling accessibility this way required the device to be plugged in via USB. I was pleasantly surprised to discover that this VoiceOver can now be toggle on and off over wifi.</p>

<h2>Enabling accessibility programmatically</h2>

<p><em>Note: these steps apply to the iOS Simulator only. If someone knows how to enable accessibility programmatically on the device, I would love to know</em></p>

<p>When you are running tests in the simulator, it&#8217;s likely that you use the <em>Reset Content and Settings&#8230;</em> menu item frequently. If you forget to reenable accessibility after this, tests will fail because UI information will not be available to the tests. We need a programmatic way to turn accessibility on. I&#8217;m not sure how to do this on the device, but in the simulator, this is just a matter of setting a flag in one of the underlying plist files. It&#8217;s possible to call plist editors from the command line to do this, but then the plist file is separate for each iOS version supported by the simulator. I find it&#8217;s easier to call from the Objective C code at run time, since it it possible to obtain the root for that version of the simulator.</p>

<figure role=code><figcaption><span></span></figcaption><div class="highlight"><table cellpadding="0" cellspacing="0"><tr><td class="gutter"><pre class="line-numbers"><span class='line'>1</span>
<span class='line'>2</span>
<span class='line'>3</span>
<span class='line'>4</span>
<span class='line'>5</span>
<span class='line'>6</span>
<span class='line'>7</span>
<span class='line'>8</span>
<span class='line'>9</span>
<span class='line'>10</span>
<span class='line'>11</span>
<span class='line'>12</span>
<span class='line'>13</span>
<span class='line'>14</span>
<span class='line'>15</span>
<span class='line'>16</span>
<span class='line'>17</span>
<span class='line'>18</span>
<span class='line'>19</span>
<span class='line'>20</span>
<span class='line'>21</span>
<span class='line'>22</span>
<span class='line'>23</span>
</pre></td><td class='code' width='100%'><pre><code class='objc'><div class='line'><span class="cp">#import &lt;dlfcn.h&gt;</span>
</div><div class='line'>
</div><div class='line'><span class="o">+</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="n">load</span>
</div><div class='line'><span class="p">{</span>
</div><div class='line'>    <span class="n">NSAutoreleasePool</span> <span class="o">*</span><span class="n">autoReleasePool</span> <span class="o">=</span> <span class="p">[[</span><span class="n">NSAutoreleasePool</span> <span class="n">alloc</span><span class="p">]</span> <span class="n">init</span><span class="p">];</span>
</div><div class='line'>
</div><div class='line'>    <span class="n">NSString</span> <span class="o">*</span><span class="n">simulatorRoot</span> <span class="o">=</span> <span class="p">[[[</span><span class="n">NSProcessInfo</span> <span class="n">processInfo</span><span class="p">]</span> <span class="n">environment</span><span class="p">]</span> <span class="nl">objectForKey:</span><span class="s">@&quot;IPHONE_SIMULATOR_ROOT&quot;</span><span class="p">];</span>
</div><div class='line'>    <span class="k">if</span> <span class="p">(</span><span class="n">simulatorRoot</span><span class="p">)</span> <span class="p">{</span>
</div><div class='line'>        <span class="kt">void</span> <span class="o">*</span><span class="n">appSupportLibrary</span> <span class="o">=</span> <span class="n">dlopen</span><span class="p">([[</span><span class="n">simulatorRoot</span> <span class="nl">stringByAppendingPathComponent:</span><span class="s">@&quot;/System/Library/PrivateFrameworks/AppSupport.framework/AppSupport&quot;</span><span class="p">]</span> <span class="n">fileSystemRepresentation</span><span class="p">],</span> <span class="n">RTLD_LAZY</span><span class="p">);</span>
</div><div class='line'>        <span class="n">CFStringRef</span> <span class="p">(</span><span class="o">*</span><span class="n">copySharedResourcesPreferencesDomainForDomain</span><span class="p">)(</span><span class="n">CFStringRef</span> <span class="n">domain</span><span class="p">)</span> <span class="o">=</span> <span class="n">dlsym</span><span class="p">(</span><span class="n">appSupportLibrary</span><span class="p">,</span> <span class="s">&quot;CPCopySharedResourcesPreferencesDomainForDomain&quot;</span><span class="p">);</span>
</div><div class='line'>
</div><div class='line'>        <span class="k">if</span> <span class="p">(</span><span class="n">copySharedResourcesPreferencesDomainForDomain</span><span class="p">)</span> <span class="p">{</span>
</div><div class='line'>            <span class="n">CFStringRef</span> <span class="n">accessibilityDomain</span> <span class="o">=</span> <span class="n">copySharedResourcesPreferencesDomainForDomain</span><span class="p">(</span><span class="n">CFSTR</span><span class="p">(</span><span class="s">&quot;com.apple.Accessibility&quot;</span><span class="p">));</span>
</div><div class='line'>
</div><div class='line'>            <span class="k">if</span> <span class="p">(</span><span class="n">accessibilityDomain</span><span class="p">)</span> <span class="p">{</span>
</div><div class='line'>                <span class="n">CFPreferencesSetValue</span><span class="p">(</span><span class="n">CFSTR</span><span class="p">(</span><span class="s">&quot;ApplicationAccessibilityEnabled&quot;</span><span class="p">),</span> <span class="n">kCFBooleanTrue</span><span class="p">,</span> <span class="n">accessibilityDomain</span><span class="p">,</span> <span class="n">kCFPreferencesAnyUser</span><span class="p">,</span> <span class="n">kCFPreferencesAnyHost</span><span class="p">);</span>
</div><div class='line'>                <span class="n">CFRelease</span><span class="p">(</span><span class="n">accessibilityDomain</span><span class="p">);</span>
</div><div class='line'>            <span class="p">}</span>
</div><div class='line'>        <span class="p">}</span>
</div><div class='line'>    <span class="p">}</span>
</div><div class='line'>
</div><div class='line'>    <span class="p">[</span><span class="n">autoReleasePool</span> <span class="n">drain</span><span class="p">];</span>
</div><div class='line'><span class="p">}</span>
</div></code></pre></td></tr></table></div></figure>


<p>I first tried to use this code in <code>init</code> for a test framework class, and it didn&#8217;t seem to work. Moving the code to be called from <code>load</code> solved the problem. Since this code actually changes a <em>plist</em> file on the file system, perhaps it needs to be executed early before the UI loads so that the rest of the system acts as if accessibility is enabled. Not only does this approach ensure accessibility is always enabled in the simulator, it doesn&#8217;t bring up the inspector over the top of the UI.</p>

<p>Special thanks to an awesome colleague of mine, Sadat Rahman (@sadatrahman) for the code above that enables accessibility in the simulator automatically.</p>
</div>
  
  


  </article>


  <article>
    
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/09/16/moving-from-wordpress-to-octopress/">Moving From Wordpress to Octopress</a></h1>
    
    
      <p class="meta">





  



<time datetime="2011-09-16T16:53:00+10:00" pubdate  data-updated="true" >Sep 16<span>th</span>, 2011</time></p>
    
  </header>


  <div class="entry-content"><p>My Wordpress blog was a complete failure in terms of content and effort on my part. I blame part of this on the barrier of having to use Wordpress, which I find bloated and slow. I want to write blogs the same way I write code: in my text editor using git to keep track of changes, and deploying with a git push. I&#8217;m hoping most of my posts will involve a lot of code snippets, so being able to edit the posts in a proper programmer&#8217;s text editor, in plain text, using Markdown is ideal.</p>

<p>I tried to get <code>jekyll</code> set up, but being a bit of a noob when it comes to stylesheets as well as Ruby, I just couldn&#8217;t find the time to get the blog set up properly. This morning I read about Matt Gemmell&#8217;s blog <a href="http://mattgemmell.com/2011/09/12/blogging-with-octopress/">moving to Octopress</a>, which seemed the best of both worlds. The simple ongoing use and management that jekyll provides, and with some additional scripts to set it all up for me.</p>

<p>I&#8217;ve gone and set it all up this afternoon, now to see if that means I actually have the time to write up posts!</p>
</div>
  
  


  </article>


  <article>
    
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/04/19/xcode-4-shortcuts-lightning-talk/">Xcode 4 Shortcuts Lightning Talk</a></h1>
    
    
      <p class="meta">





  



<time datetime="2011-04-19T16:46:00+10:00" pubdate  data-updated="true" >Apr 19<span>th</span>, 2011</time></p>
    
  </header>


  <div class="entry-content"><p>Last week I have a short lightning talk with Jesse Collis (@sirjec) at the Melbourne Cocoaheads meetup. The topic was fairly boring, just some useful Xcode 4 shortcuts we have found since switching from Xcode 3 a few weeks ago. It ended up being a bit of a laugh, probably the first and only time a talk about keyboard shortcuts will be funny - I think it had something to do with the pizza and beer that had just arrived.</p>

<p>Jesse saved me the effort of writing up anything more and linking to the slides on his blog below.</p>

<p><a href="http://blog.jcmultimedia.com.au/2011/04/xcode4-shortcuts-melbourne-cocoaheads-april-2011.html">http://blog.jcmultimedia.com.au/2011/04/xcode4-shortcuts-melbourne-cocoaheads-april-2011.html</a></p>

<p>I&#8217;ve managed to find the <a href="http://vimeo.com/22598371">video footage of the xcode shortcuts talk</a> put together by Oliver Jones (@orj) on vimeo. After flicking through the footage a couple of questions were raised that I can now answer:</p>

<ul>
<li>Q: <em>Does Cmd+Option+[ or ] work if multiple lines are selected?</em><br/>
A: Yes.</li>
<li>Q: <em>Does Ctrl+6 for the class outline in the jump bar work in non-primary editors?</em><br/>
A: Yes, it is based on the editor that has focus.</li>
<li>Follow up: <em>Proper clean (Cmd+Option+Shift+K) did not completely clean the build for us.</em><br/>
<code>rm -rf</code> is still your friend</li>
</ul>


<p>The Melbourne Cocoaheads faithful also contributed some keyboard shortcuts of their own, here are the ones I jotted down:</p>

<ul>
<li><em>Cmd+Ctrl+Opt+?</em> - open item under the cursor in Xcode help (&#8220;real help, not the stupid little help&#8221; @tupps)</li>
<li><em>Cmd+Double-Click</em> - drill through to the implementation</li>
<li><em>Cmd+Opt+,</em> - open current file back in the main editor</li>
<li><em>Cmd+/</em> - Comment Line</li>
<li><em>Cmd+Shift+[ or ]</em> - navigate back and forth between tabs</li>
<li><em>Cmd+T</em> - Open new tab (same as Safari)</li>
<li><em>Cmd+Ctrl+Up and Down</em> - switch between counterparts</li>
</ul>


<p>and a few more shortcuts I&#8217;ve found since then:</p>

<ul>
<li><em>Cmd+Ctrl+Opt+Up</em> - open up the counterpart in the secondary editor</li>
<li><em>&#8230;</em> - Organise Import&#8230; just kidding. Maybe one day.</li>
</ul>


<p>I&#8217;m sure there are plenty more shortcuts I haven&#8217;t found yet. Let me know the ones you find most useful.</p>
</div>
  
  


  </article>


  <article>
    
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/03/27/rvm-escaping-gem-dependency-hell/">RVM: Escaping Gem Dependency Hell</a></h1>
    
    
      <p class="meta">





  



<time datetime="2011-03-27T16:02:00+11:00" pubdate  data-updated="true" >Mar 27<span>th</span>, 2011</time></p>
    
  </header>


  <div class="entry-content"><p>This is my second post on my move to rvm. The first being about <a href="blog/2011/03/27/cleaning-out-ruby-gems-under-os-x/">cleaning out my existing gems</a> for a fresh start.</p>

<p>Bundler seemed like it was the ideal solution to having specific gems for specific projects, but it seems to install in your system gems by default causing version and dependency conflicts with other projects I&#8217;m working on. I know I can use <code>bundle --deployment</code> but then I have to <code>bundle exec</code> everything and I don&#8217;t have enough Ruby-fu to use the bundler-managed gems within Rakefile etc.</p>

<p>I&#8217;m looking to <a href="http://rvm.beginrescueend.com/">rvm</a> to solve the problem. The steps I followed are below:</p>

<h2>Installing RVM</h2>

<p>There are some pretty good <a href="http://rvm.beginrescueend.com/rvm/install/">installation instructions</a> on the rvm site. The actual installation is a just single command.</p>

<figure role=code><figcaption><span></span></figcaption><div class="highlight"><table cellpadding="0" cellspacing="0"><tr><td class="gutter"><pre class="line-numbers"><span class='line'>1</span>
</pre></td><td class='code' width='100%'><pre><code class='bash'><div class='line'><span class="nv">$ </span>bash &lt; &lt;<span class="o">(</span>curl -B http://rvm.beginrescueend.com/install/rvm<span class="o">)</span>
</div></code></pre></td></tr></table></div></figure>


<p>You&#8217;ll see a bunch of output, and towards the bottom, a confirmation message saying &#8220;Installation of RVM to /Users/sgleadow/.rvm/ is complete.&#8221;, but that&#8217;s not all. You need to set up your shell to know about rvm. Put the following line into your .bash_profile or wherever your chosen shell wants it.</p>

<figure role=code><figcaption><span></span></figcaption><div class="highlight"><table cellpadding="0" cellspacing="0"><tr><td class="gutter"><pre class="line-numbers"><span class='line'>1</span>
</pre></td><td class='code' width='100%'><pre><code class='bash'><div class='line'><span class="o">[[</span> -s <span class="s2">&quot;$HOME/.rvm/scripts/rvm&quot;</span> <span class="o">]]</span> <span class="o">&amp;&amp;</span> . <span class="s2">&quot;$HOME/.rvm/scripts/rvm&quot;</span>
</div></code></pre></td></tr></table></div></figure>


<p>After that, source your profile and check rvm is present and accessible.</p>

<figure role=code><figcaption><span></span></figcaption><div class="highlight"><table cellpadding="0" cellspacing="0"><tr><td class="gutter"><pre class="line-numbers"><span class='line'>1</span>
<span class='line'>2</span>
<span class='line'>3</span>
<span class='line'>4</span>
<span class='line'>5</span>
<span class='line'>6</span>
<span class='line'>7</span>
</pre></td><td class='code' width='100%'><pre><code class='bash'><div class='line'><span class="nv">$ </span><span class="nb">source</span> ~/.bash_profile
</div><div class='line'><span class="nv">$ </span>which rvm/Users/sgleadow/.rvm/bin/rvm
</div><div class='line'>/Users/sgleadow/.rvm/bin/rvm
</div><div class='line'><span class="nv">$ </span>rvm --version
</div><div class='line'>rvm 1.5.2 by Wayne E. Seguin <span class="o">(</span>wayneeseguin@gmail.com<span class="o">)</span> <span class="o">[</span>http://rvm.beginrescueend.com/<span class="o">]</span>
</div><div class='line'><span class="nv">$ </span><span class="nb">type </span>rvm | head -1
</div><div class='line'>rvm is a <span class="k">function</span>
</div></code></pre></td></tr></table></div></figure>


<h2>Installing some Rubies</h2>

<p>Now that rvm is installed, let&#8217;s install some rubies to use with it. First, check which ruby versions are available.</p>

<figure role=code><figcaption><span></span></figcaption><div class="highlight"><table cellpadding="0" cellspacing="0"><tr><td class="gutter"><pre class="line-numbers"><span class='line'>1</span>
<span class='line'>2</span>
<span class='line'>3</span>
<span class='line'>4</span>
</pre></td><td class='code' width='100%'><pre><code class='bash'><div class='line'><span class="nv">$ </span>rvm list known
</div><div class='line'>...
</div><div class='line'><span class="o">[</span>ruby-<span class="o">]</span>1.8.7<span class="o">[</span>-p334<span class="o">]</span>
</div><div class='line'>...
</div></code></pre></td></tr></table></div></figure>


<p>I&#8217;ll install the main two versions that I&#8217;m using at the moment. Each install will take a few minutes, so this is a good time to make a cup of tea. I would usually say coffee but I haven&#8217;t bought any fresh coffee beans in a while and the stuff I has is so old that the coffee tastes like sawdust.</p>

<figure role=code><figcaption><span></span></figcaption><div class="highlight"><table cellpadding="0" cellspacing="0"><tr><td class="gutter"><pre class="line-numbers"><span class='line'>1</span>
<span class='line'>2</span>
</pre></td><td class='code' width='100%'><pre><code class='bash'><div class='line'><span class="nv">$ </span>rvm install 1.8.7
</div><div class='line'><span class="nv">$ </span>rvm install 1.9.2
</div></code></pre></td></tr></table></div></figure>


<p>I&#8217;m still using 1.8.7 for some things at the moment, so I&#8217;ll set that up as the default, and double check that the active ruby binary is now the one I just installed using rvm.</p>

<figure role=code><figcaption><span></span></figcaption><div class="highlight"><table cellpadding="0" cellspacing="0"><tr><td class="gutter"><pre class="line-numbers"><span class='line'>1</span>
<span class='line'>2</span>
<span class='line'>3</span>
<span class='line'>4</span>
<span class='line'>5</span>
<span class='line'>6</span>
<span class='line'>7</span>
<span class='line'>8</span>
<span class='line'>9</span>
<span class='line'>10</span>
</pre></td><td class='code' width='100%'><pre><code class='bash'><div class='line'><span class="nv">$ </span>rvm --default use 1.8.7
</div><div class='line'><span class="nv">$ </span>ruby -v
</div><div class='line'>ruby 1.8.7 <span class="o">(</span>2011-02-18 patchlevel 334<span class="o">)</span> <span class="o">[</span>i686-darwin10.7.0<span class="o">]</span>
</div><div class='line'><span class="nv">$ </span>which ruby
</div><div class='line'>/Users/sgleadow/.rvm/rubies/ruby-1.8.7-p334/bin/ruby
</div><div class='line'><span class="nv">$ </span>which gem
</div><div class='line'>/Users/sgleadow/.rvm/rubies/ruby-1.8.7-p334/bin/gem
</div><div class='line'><span class="nv">$ </span>rvm list default
</div><div class='line'>Default Ruby <span class="o">(</span><span class="k">for </span>new shells<span class="o">)</span>
</div><div class='line'>ruby-1.8.7-p334 <span class="o">[</span> x86_64 <span class="o">]</span>
</div></code></pre></td></tr></table></div></figure>


<p>Done. We have rvm up and running</p>

<h2>Setting up your gemsets</h2>

<p>While rvm solves the issue of having multiple versions of ruby installed on the one machine, and switching between them, it also allows you to set up multiple gemsets, which is the feature that started me on this journey in the first place. I&#8217;d like to set up a separate gemset for each separate project to try and keep them separate and escape from dependency hell.</p>

<p>I should have a pretty clean slate to start on for my gems. I&#8217;m not 100% on whether rvm will use my old system gems or not, but I&#8217;ve cleaned them all out anyway, so it shouldn&#8217;t be a problem.</p>

<figure role=code><figcaption><span></span></figcaption><div class="highlight"><table cellpadding="0" cellspacing="0"><tr><td class="gutter"><pre class="line-numbers"><span class='line'>1</span>
<span class='line'>2</span>
<span class='line'>3</span>
<span class='line'>4</span>
<span class='line'>5</span>
<span class='line'>6</span>
<span class='line'>7</span>
<span class='line'>8</span>
<span class='line'>9</span>
</pre></td><td class='code' width='100%'><pre><code class='bash'><div class='line'><span class="nv">$ </span>gem list
</div><div class='line'>*** LOCAL GEMS ***
</div><div class='line'>rake <span class="o">(</span>0.8.7<span class="o">)</span>
</div><div class='line'><span class="nv">$ </span>rvm list gemsets
</div><div class='line'>rvm <span class="nv">gemsets</span>
</div><div class='line'><span class="o">=</span>&gt; ruby-1.8.7-head <span class="o">[</span> x86_64 <span class="o">]</span>
</div><div class='line'>   ruby-1.8.7-head@global <span class="o">[</span> x86_64 <span class="o">]</span>
</div><div class='line'>   ruby-1.9.2-head <span class="o">[</span> x86_64 <span class="o">]</span>
</div><div class='line'>   ruby-1.9.2-head@global <span class="o">[</span> x86_64 <span class="o">]</span>
</div></code></pre></td></tr></table></div></figure>


<p>rvm will set up a default gemset for you, but I&#8217;d like to have each project automatically set its own ruby version and gemset. We can use the .rvmrc file to achieve this. I&#8217;m setting a project up that uses the <a href="https://github.com/moredip/Frank">Frank</a> iOS testing tool, below is a sample of the .rvmrc file I have <em>inside</em> that my project root directory. When I enter that directory in the shell, rvm picks up the rc file and will switch to that version of ruby (the part before the @) and also switch to a specific gemset (the part after the @). The <code>--create</code> means that if the gemset does not already exist, create one. The first time you enter the directory, you will need to specifically allow rvm to do this. After that, it&#8217;s automatic.</p>

<figure role=code><figcaption><span></span></figcaption><div class="highlight"><table cellpadding="0" cellspacing="0"><tr><td class="gutter"><pre class="line-numbers"><span class='line'>1</span>
<span class='line'>2</span>
</pre></td><td class='code' width='100%'><pre><code class='bash'><div class='line'><span class="nv">$ </span>cat my_project/.rvmrc
</div><div class='line'>rvm --create use ruby-1.8.7-p334@frank
</div></code></pre></td></tr></table></div></figure>


<p>Once the .rvmrc file is created, leave and return to the directory to kick it off, authorise it and you should see something like <code>Using /Users/sgleadow/.rvm/gems/ruby-1.8.7-p334 with gemset frank</code> printed to the console. To double check we are, in fact, using the newly created gemset, use <code>rvm list gemsets</code> or <code>rvm gemset list</code> and check the little hashrocket is pointing to the new gemset. Do another <code>gem list</code> to double check you have a clean slate.</p>

<p>Most of my projects use bundler, so first I&#8217;ll need to install that, then I can use bundler to manage all the gems I need installed. Before using bundler, I wanted to remove the existing gems that had been used by bundler.</p>

<figure role=code><figcaption><span></span></figcaption><div class="highlight"><table cellpadding="0" cellspacing="0"><tr><td class="gutter"><pre class="line-numbers"><span class='line'>1</span>
<span class='line'>2</span>
<span class='line'>3</span>
<span class='line'>4</span>
</pre></td><td class='code' width='100%'><pre><code class='bash'><div class='line'><span class="nv">$ </span>rm .bundle/config
</div><div class='line'><span class="nv">$ </span>rm -r vendor/bundle
</div><div class='line'><span class="nv">$ </span>gem install bundler
</div><div class='line'><span class="nv">$ </span>bundle
</div></code></pre></td></tr></table></div></figure>


<p>Bundler should install all the gems listed in the Gemfile into the gemset you have just defined for this project. Once bundle is complete, check the gems were installed in the gemset and not just in vendor with <code>gem list</code>. If you&#8217;re project is all set up with a Rakefile to run your tests, try that to double check everything has gone smoothly.</p>
</div>
  
  


  </article>


  <article>
    
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/03/27/cleaning-out-ruby-gems-under-os-x/">Cleaning Out Ruby Gems Under OS X</a></h1>
    
    
      <p class="meta">





  



<time datetime="2011-03-27T15:55:00+11:00" pubdate  data-updated="true" >Mar 27<span>th</span>, 2011</time></p>
    
  </header>


  <div class="entry-content"><p>As a bit of background, I have been getting into Ruby development for the past year, but I have been getting into gem dependency hell recently. Different projects need different gemsets. <a href="http://gembundler.com/">Bundler</a> helps but I want to use that in combination with <a href="http://rvm.beginrescueend.com/">rvm</a> to keep things organised.</p>

<p>To get a clean start with rvm, so I wanted to remove all my existing system gems. My first attempt used the little shell script below to loop over all installed gems and remove them. That worked for a lot of gems, but left some behind, possibly all the default gems that come pre-installed with OS X.</p>

<p><code>$ for x in `gem list --no-versions` ; do gem uninstall -aIx $x; done</code></p>

<p>After some googling, the next step I tried was to physically remove the gem directories that are returned by <code>gem env paths</code>. After that, <code>gem list</code> said there were no gems installed. There were still some binaries left over that depended on these gems, like <code>spec</code>, <code>rails</code>, <code>rake</code> in <code>/usr/bin</code>. These binaries no longer worked as the actual gem was gone, so I removed them.Â I couldn&#8217;t find a definitive list of the OS X default gems so I stopped here.</p>

<p>I&#8217;m not a shell guru by any means, but below is my attempt at a quick one line shell script to remove all the existing gem directories.</p>

<p><code>rm -rf `gem env paths | tr ":" " "`</code></p>
</div>
  
  


  </article>


  <article>
    
  <header>
    
      <h1 class="entry-title"><a href="/blog/2011/03/26/hello-world/">Hello World</a></h1>
    
    
      <p class="meta">





  



<time datetime="2011-03-26T15:47:00+11:00" pubdate  data-updated="true" >Mar 26<span>th</span>, 2011</time></p>
    
  </header>


  <div class="entry-content"><p>I&#8217;ve been meaning to start a blog for a while know. Until now, I&#8217;ve kept notes to myself in all sorts of places about problems I&#8217;ve encountered while developing software and solutions I&#8217;ve found. My favourite way of keeping notes to date is in a nice Moleskine notebook with a fountain pen - a bit backwards I know, you wouldn&#8217;t believe I write software for a living.</p>

<p>Often my notes just disappear into the depths of my filesystem or bookshelf never to be seen again. If I&#8217;m really proactive, I might write up an answer on Stack Overflow or reply to a mailing list. The next time I want to share that experience, I have to filter through to find that information again</p>

<p>Hopefully a blog will be an easier way to keep track of this information and later refer to it. Whether it&#8217;s useful information or not remains to be seen, but it will at least be useful to me. For shorter, random and less useful musings, I&#8217;m on twitter at @stewgleadow</p>

<p>The current topics I&#8217;m interested in are:</p>

<ul>
<li>Objective C and native iOS apps</li>
<li>testing iOS apps, mainly with GHUnit and Frank</li>
<li>ReST APIs in Ruby/Rails</li>
<li>hand-wavy discussion about agile software development and testing in general</li>
</ul>


<p>User groups I&#8217;m involved in or attend occasionally:</p>

<ul>
<li><a href="http://www.melbournecocoaheads.com/">Melbourne Cocoaheads</a></li>
<li><a href="http://melbournepatterns.org/">Melbourne Patterns Group</a></li>
<li><a href="http://www.meetup.com/Agile-Melbourne/">Agile Alliance</a></li>
<li><a href="http://www.yowconference.com.au/">YOW Conference and tech nights</a></li>
<li><a href="http://www.swipeconference.com.au">Swipe Conference</a></li>
</ul>

</div>
  
  


  </article>

<nav role="pagination">
  <div>
    
    <a href="/blog/archives">Blog Archives</a>
    
  </div>
</nav>

<script type="text/javascript">
    var disqus_shortname = 'sgleadow-blog';
    (function () {
      var s = document.createElement('script'); s.async = true;
      s.type = 'text/javascript';
      s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
      (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>

</div>
<aside role=sidebar>
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2011/10/28/universal-static-libraries-and-frameworks-for-ios/">Universal Static Libraries and Frameworks for iOS</a>
      </li>
    
      <li class="post">
        <a href="/blog/2011/10/26/which-automated-ios-testing-tool-to-use/">Which Automated iOS Testing Tool To Use</a>
      </li>
    
      <li class="post">
        <a href="/blog/2011/10/14/enabling-accessibility-for-ios-applications/">Enabling Accessibility for iOS applications</a>
      </li>
    
      <li class="post">
        <a href="/blog/2011/09/16/moving-from-wordpress-to-octopress/">Moving From Wordpress to Octopress</a>
      </li>
    
      <li class="post">
        <a href="/blog/2011/04/19/xcode-4-shortcuts-lightning-talk/">Xcode 4 Shortcuts Lightning Talk</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>Github Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/sgleadow">@sgleadow</a> on Github
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'sgleadow',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>


<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("stewgleadow", 4, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/stewgleadow" class="twitter-follow-button" data-width="208px" data-show-count="false">Follow @stewgleadow</a>
  
</section>


  
</aside>

    </div>
  </div>
  <footer><p>
  Copyright &copy; 2011 - Stewart Gleadow -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

  
  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>


  
  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>


</body>
</html>
